<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSS Pong Game</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <style>
        @property --ping-position {
          syntax: "<number>";
          inherits: true;
          initial-value: 10;
        }

        @property --int-ball-position-x {
          syntax: "<number>";
          inherits: true;
          initial-value: 10;
        }

        @property --ball-position-y {
          syntax: "<number>";
          inherits: true;
          initial-value: 0;
        }

        @property --ball-position-x {
          syntax: "<number>";
          inherits: true;
          initial-value: 0;
        }

        @property --min-ball-position-y-and-top-of-paddle {
          syntax: "<number>";
          inherits: true;
          initial-value: 0;
        }

        @property --min-ball-position-y-and-bottom-of-paddle {
          syntax: "<number>";
          inherits: true;
          initial-value: 0;
        }

        @property --lives {
          syntax: "<string>";
          inherits: true;
          initial-value: '3';
        }

        :root {
            animation: ping 1s forwards;
            animation-timeline: --myScroller;
            timeline-scope: --myScroller;
            --paddle-height: 12;
            --ball-left-boundary: 8;
        }

        body {
            height: 100vh;
            box-sizing: border-box;
            background: #000000;
            animation: ball 8s infinite linear, lives 80ms forwards steps(4) var(--lives-decrement);
            --int-ball-position-x: round(down, var(--ball-position-x));
            --min-ball-position-y-and-top-of-paddle: min(var(--ball-position-y) + 5, var(--ping-position));
            --min-ball-position-y-and-bottom-of-paddle: min(var(--ball-position-y), var(--ping-position) + var(--paddle-height));
            --lives-decrement: paused;
        }

        .screen {
            display: flex;
            height: 100%;
            animation: lives 80ms forwards steps(4) var(--lives-decrement);
        }

        .game-over {
            margin: auto;
            justify-content: center;
            color: #ffffff;
            font-family: "Press Start 2P", system-ui;
            font-weight: 400;
            text-transform: uppercase;
            display: none;
            flex-flow: column;
            justify-content: space-around;
            height: 130px;
        }

        .game-over div {
            align-self: center;
        }

        .field {
            margin: auto;
            width: 200px;
            height: 130px;
            position: relative;
            border-width: 3px;
            border-style: solid;
            border-color: #ffffff;
            animation-play-state: paused;
        }

        .field .lives {
            font-family: "Press Start 2P", system-ui;
            font-weight: 400;
            font-style: normal;
            color: #ffffff;
            font-size: .6em;
            text-transform: uppercase;
            justify-self: center;
            margin-top: -15px;
        }

        .field .lives::after {
            content: var(--lives);
        }

        .field .net {
            width: 0;
            height: 95%;
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            border-width: 3px;
            border-style: dotted;
            border-color: #ffffff;
        }

        .field .ping,
        .field .pong {
            width: 4px;
            height: calc(var(--paddle-height) * 1%);
            position: absolute;
            background: #ffffff;
        }

        .field .ping {
            left: 6%;
            top: calc(var(--ping-position) * 1%);
        }

        .field .pong {
            right: 6%;
            animation: pong 8s infinite linear;
        }

        .field .ball {
            width: 5px;
            height: 5px;
            position: absolute;
            background: #ffffff;
            top: calc(var(--ball-position-y) * 1%);
            left: calc(var(--ball-position-x) * 1%);
        }

        @container style(--int-ball-position-x: var(--ball-left-boundary)) {
            .screen {
                --lives-decrement: running;
            }
            .screen .field {
                background: red;
            }
        }

        @container style(--min-ball-position-y-and-top-of-paddle: var(--ping-position)) and style(--min-ball-position-y-and-bottom-of-paddle: var(--ball-position-y)) and style(--int-ball-position-x: var(--ball-left-boundary)) {
            .screen {
                --lives-decrement: paused;
            }
            .screen .field {
                background: green;
            }
        }

        @container style(--lives: '0') {
            .field {
                display: none;
            }
            .game-over {
                display: flex;
            }
        }

        :root:has(.reset:active) *,
        :root:has(.reset:active) {
            animation-name: none;
        }

        @keyframes ball {
            0% {
                --ball-position-y: 34;
                --ball-position-x: 52;
            }
            8.3% {
                --ball-position-y: 52;
                --ball-position-x: 90;
            }
            24.9% {
                --ball-position-y: 85;
                --ball-position-x: 8;
            }
            30% {
                --ball-position-y: 98;
                --ball-position-x: 27;
            }
            41.5% {
                --ball-position-y: 70;
                --ball-position-x: 90;
            }
            58.1% {
                --ball-position-y: 55;
                --ball-position-x: 8;
            }
            74.7% {
                --ball-position-y: 13;
                --ball-position-x: 90;
            }
            79% {
                --ball-position-y: 1;
                --ball-position-x: 70;
            }
            91.3% {
                --ball-position-y: 22;
                --ball-position-x: 8;
            }
            100% {
                --ball-position-y: 34;
                --ball-position-x: 52;
            }
        }

        @keyframes ping {
            0% {
                --ping-position: 90;
            }
            100% {
                --ping-position: 15;
            }
        }

        @keyframes pong {
            0% {
                top: 90%;
            }
            8.3% {
                top: 51%;
            }
            20% {
                top: 60%;
            }
            25% {
                top: 34%;
            }
            41.5% {
                top: 68%;
            }
            46% {
                top: 36%;
            }
            52% {
                top: 18%;
            }
            58.1% {
                top: 53%;
            }
            66% {
                top: 14%;
            }
            70% {
                top: 20%;
            }
            74.7% {
                top: 10%;
            }
            91.3% {
                top: 10%;
            }
            100% {
                top: 90%;
            }
        }

        @keyframes lives {
            0% {
                --lives: "3";
            }
            25% {
                --lives: "2";
            }
            75% {
                --lives: "1";
            }
            100% {
                --lives: "0";
            }
        }

        input[type="range"] {
            overflow: hidden;
            writing-mode: vertical-lr;
            margin-left: -30px;
            z-index: 99;
        }

        input[type="range"]::-webkit-slider-thumb {
            view-timeline: var(--timeline) inline;
        }

        input[type="range"]::-moz-range-thumb {
            view-timeline: var(--timeline) inline;
        }
    </style>
</head>
<body>
    <div class="screen">
        <div class="field">
            <div class="lives">Lives:</div>
            <input type="range" min="0" max="100" step="0.1" value="0" style="--timeline: --myScroller;">
            <div class="net"></div>
            <div class="ping"></div>
            <div class="pong"></div>
            <div class="ball"></div>
        </div>

        <div class="game-over">
            <div>Game over</div>
            <div><a class="reset" href="#">Play again</a></div>
        </div>
    </div>
</body>
</html>
